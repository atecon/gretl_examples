#written by
#Allin Cottrell

#"Yes, it's intended.  The residuals we report from WLS are the same
#as those reported by R. They represent the deviations of actual y
#from the predictions for y generated by the coefficients of the
#weighted model applied to actual X.
#The following script illustrates the point."

open data4-1
series w = 1/sqft
wls w price 0 sqft
series u1 = $uhat
series chk1 = price - ($coeff[1] + $coeff[2]*sqft)
series ystar = price/sqrt(sqft)
series cstar = 1/sqrt(sqft)
series xstar = sqft/sqrt(sqft)
ols ystar cstar xstar
series u2 = $uhat
series chk2 = ystar - ($coeff[1]*cstar + $coeff[2]*xstar)
print u1 chk1 u2 chk2 -o
# compare R, if available
foreign language=R --send-data
  y <- gretldata[,"price"]
  x <- gretldata[,"sqft"]
  w <- gretldata[,"w"]
  model <- lm(y ~ x, weights=w)
  model
  model$residuals
end foreign
